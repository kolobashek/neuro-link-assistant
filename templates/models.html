{% extends "base.html" %}

{% block title %}AI Модели - Neuro Link Assistant{% endblock %}

{% block content %}
<div class="models-page">
  <div class="page-header">
    <h1><i class="fas fa-robot"></i> Управление AI моделями</h1>
    <p class="page-description">Настройка и управление искусственным интеллектом</p>
  </div>

  <!-- Табовая навигация -->
  <div class="models-tabs">
    <button class="tab-btn active" data-tab="active-models">
      <i class="fas fa-check-circle"></i>
      <span>Активные модели</span>
      <span class="badge" id="active-count">0</span>
    </button>
    <button class="tab-btn" data-tab="catalog-models">
      <i class="fas fa-database"></i>
      <span>Каталог моделей</span>
      <span class="badge" id="catalog-count">0</span>
    </button>
    <button class="tab-btn" data-tab="search-models">
      <i class="fas fa-search"></i>
      <span>Поиск новых</span>
    </button>
  </div>

  <!-- Контент табов -->
  <div class="models-content">

    <!-- TAB 1: Активные модели -->
    <div class="tab-panel active" id="active-models">
      <div class="panel-header">
        <h2>Активные модели</h2>
        <div class="panel-actions">
          <button class="btn btn-outline-primary" id="refresh-active">
            <i class="fas fa-sync"></i> Обновить
          </button>
          <button class="btn btn-warning" id="check-all">
            <i class="fas fa-check-circle"></i> Проверить все
          </button>
        </div>
      </div>

      <div class="models-grid active-grid" id="active-models-grid">
        <div class="loading-placeholder">
          <i class="fas fa-spinner fa-spin"></i>
          Загрузка активных моделей...
        </div>
      </div>
    </div>

    <!-- TAB 2: Каталог моделей -->
    <div class="tab-panel" id="catalog-models">
      <div class="panel-header">
        <h2>Каталог доступных моделей</h2>
        <div class="catalog-filters">
          <select class="filter-select" id="provider-filter">
            <option value="">Все провайдеры</option>
            <option value="openai">OpenAI</option>
            <option value="anthropic">Anthropic</option>
            <option value="google">Google</option>
            <option value="huggingface">HuggingFace</option>
          </select>
          <select class="filter-select" id="status-filter">
            <option value="">Все статусы</option>
            <option value="ready">Готов</option>
            <option value="busy">Занят</option>
            <option value="unavailable">Недоступен</option>
            <option value="error">Ошибка</option>
          </select>
          <div class="search-box">
            <input type="text" placeholder="Поиск по названию..." id="catalog-search">
            <i class="fas fa-search"></i>
          </div>
        </div>
      </div>

      <div class="models-grid catalog-grid" id="catalog-models-grid">
        <div class="loading-placeholder">
          <i class="fas fa-spinner fa-spin"></i>
          Загрузка каталога моделей...
        </div>
      </div>
    </div>

    <!-- TAB 3: Поиск новых -->
    <div class="tab-panel" id="search-models">
      <div class="panel-header">
        <h2>Поиск новых моделей на HuggingFace</h2>
        <p class="panel-description">Найдите и добавьте новые модели из HuggingFace Hub</p>
      </div>

      <div class="search-section">
        <div class="search-form-advanced">
          <div class="search-input-group">
            <input type="text" id="hf-search-input" placeholder="Поиск моделей (минимум 2 символа)..." minlength="2">
            <button id="hf-search-btn" class="btn btn-primary">
              <i class="fas fa-search"></i> Поиск
            </button>
          </div>
          <div class="search-options">
            <label class="checkbox-label">
              <input type="checkbox" id="search-text-gen">
              <span>Только генерация текста</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="search-popular">
              <span>Только популярные (>1000 загрузок)</span>
            </label>
          </div>
        </div>

        <div id="hf-search-results" class="search-results">
          <div class="empty-state">
            <i class="fas fa-search"></i>
            <h3>Начните поиск</h3>
            <p>Введите название модели или ключевые слова для поиска</p>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Модальное окно конфигурации модели -->
<div class="modal" id="model-config-modal">
  <div class="modal-content large">
    <div class="modal-header">
      <h2 id="config-modal-title">Настройка модели</h2>
      <button class="modal-close" data-modal="model-config-modal">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body" id="config-modal-body">
      <!-- Содержимое загружается динамически -->
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" id="save-config">Сохранить</button>
      <button class="btn btn-outline" data-modal="model-config-modal">Отмена</button>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/models_new.css') }}">
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/models_new.js') }}"></script>
{% endblock %}
