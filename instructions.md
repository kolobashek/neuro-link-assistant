## 1. Обзор проекта

**Neuro-Link Assistant** - платформа для оркестрации различных моделей искусственного интеллекта и автоматизации задач. Система объединяет доступ к разным типам моделей AI и обеспечивает пошаговое выполнение задач.

## 2. Методология разработки - TDD "сверху вниз"

Проект разрабатывается с использованием **TDD (Test-Driven Development)** с подходом "сверху вниз":

1. **Системные тесты сначала** - создаем высокоуровневые тесты, описывающие работу системы в целом
2. **"Красный-Зеленый-Рефакторинг"**:
   - **Красный**: Начинаем с системных тестов, которые не проходят
   - **Зеленый**: Реализуем необходимую функциональность для прохождения тестов
   - **Рефакторинг**: Улучшаем код, сохраняя работающие тесты

## 3. Текущее состояние тестирования

### 3.1. Реализованные системные тесты

| Название теста | Статус | Описание | Приоритет |
|----------------|--------|----------|-----------|
| test_application_workflow | ✅ Проходит | Базовый рабочий процесс приложения | Выполнено |
| test_llm_basic_interaction | ✅ Проходит | Взаимодействие с языковыми моделями | Выполнено |
| test_task_management | ✅ Проходит | Жизненный цикл задачи и история | Выполнено |
| test_windows_automation | ✅ Проходит | Автоматизация работы с Windows-приложениями | Выполнено |
| test_file_operations | ✅ Проходит | Создание, чтение, запись, удаление файлов | Выполнено |
| test_computer_vision | ✅ Проходит | Захват экрана и распознавание элементов | Выполнено |
| test_web_automation | ❌ Не проходит | Автоматизация веб-поиска | Средний |
| test_model_orchestration | ❌ Не проходит | Оркестрация нескольких моделей | Низкий |
| test_plugin_system | ⚠️ Пропускается | Загрузка и выполнение плагинов | Низкий |

**Прогресс: 6/9 тестов проходят (67%)**

### 3.2. Последние достижения (2025-05-28)

✅ **Реализована система компьютерного зрения**:
- **Интеграция компонентов vision** в SystemInitializer
- **Распознавание операций компьютерного зрения** в Task
- **Захват экрана и локализация элементов** с возвратом координат
- Регистрация ScreenCapture и ElementLocalization в системе

✅ **Системные тесты**: 6 из 9 проходят (67% прогресс)
✅ **Покрытие кода**: 19% (было 14%)

### 3.3. Необходимые компоненты для реализации

Для прохождения оставшихся тестов требуется:

1. **Веб-автоматизация** (средний приоритет):
   - Улучшение стабильности BrowserController
   - Оптимизация поиска элементов на веб-страницах
   - Обработка таймаутов и ошибок загрузки

2. **Оркестрация моделей** (низкий приоритет):
   - Координация работы нескольких AI-моделей
   - Передача данных между моделями
   - Управление последовательностью выполнения

3. **Система плагинов** (низкий приоритет):
   - Создание тестовых плагинов
   - Механизм загрузки и выгрузки плагинов

## 4. План разработки (обновленный)

### 4.1. Ближайшие задачи (средний приоритет)

1. **Веб-автоматизация**:
   ```bash
   pytest tests/system/test_web_automation.py -v
   ```
   - Улучшение стабильности браузерных операций
   - Оптимизация ElementFinder для надежного поиска элементов
   - Обработка динамического контента веб-страниц

### 4.2. Задачи низкой срочности

1. **Оркестрация моделей**:
   ```bash
   pytest tests/system/test_model_orchestration.py -v
   ```

2. **Система плагинов** (создание тестовых плагинов):
   ```bash
   pytest tests/system/test_plugin_system.py -v
   ```

## 5. Архитектура системы

```
core/
├── common/                       # Общие компоненты и базовые классы
│   ├── error_handler.py          # Обработка ошибок ✅
│   ├── filesystem/               # Абстракции файловой системы ✅
│   ├── input/                    # Абстракции ввода ✅
│   └── registry/                 # Компоненты реестра ✅
│
├── platform/                     # Платформенно-зависимый код
│   └── windows/                  # Реализации для Windows
│       ├── filesystem/           # Файловые операции Windows ✅
│       └── input/                # Ввод Windows ✅
│
├── vision/                       # Компьютерное зрение ✅
│   ├── screen_capture.py         # Захват экрана ✅
│   ├── element_localization.py   # Локализация элементов ✅
│   ├── element_recognition.py    # Распознавание элементов ✅
│   ├── image_comparison.py       # Сравнение изображений ✅
│   └── screen_changes.py         # Отслеживание изменений ✅
│
├── web/                          # Веб-автоматизация
│   ├── browser_controller.py     # Управление браузером ⚠️
│   └── element_finder.py         # Поиск элементов ⚠️
│
├── system.py                     # Класс System ✅
├── system_initializer.py         # Инициализатор системы ✅
├── task.py                       # Класс Task и TaskResult ✅
├── task_manager.py               # Менеджер задач ✅
├── plugin_manager.py             # Менеджер плагинов ✅
│
└── подсистемы (llm) # Требуют интеграции
```

## 6. Следующие шаги по TDD

1. **Веб-автоматизация** (средний приоритет):
   ```bash
   pytest tests/system/test_web_automation.py -v
   ```

2. **Оркестрация моделей** (низкий приоритет):
   ```bash
   pytest tests/system/test_model_orchestration.py -v
   ```

3. **Система плагинов** (низкий приоритет):
   ```bash
   pytest tests/system/test_plugin_system.py -v
   ```

## 7. Стандарты кодирования

- **Классы**: CamelCase (например, `FileManager`)
- **Методы и функции**: snake_case (например, `read_file`)
- **Константы**: UPPER_SNAKE_CASE (например, `DEFAULT_TIMEOUT`)
- **Абстракции**: префикс Abstract (например, `AbstractFileSystem`)
- **Docstrings**: для всех публичных классов и методов
- **Типизация**: использовать аннотации типов (type hints)

## 8. Приоритеты интеграции существующего кода

1. **core/web/**: улучшение стабильности браузерных операций ⭐
2. **core/vision/**: интегрировано и работает ✅
3. **core/platform/windows/**: интегрировано и работает ✅
4. **core/common/**: базовые компоненты работают ✅

## 9. Покрытие кода и метрики

- **Текущее покрытие тестами**: **19%** (↗️ было 14%)
- **Целевое покрытие**: **80%**
- **Системные тесты**: **6/9 проходят** (67% прогресс)
- Регулярно проверять покрытие новой функциональности тестами

## 10. Организация проекта и процесс разработки

1. **Создание системного теста** - определяем требуемое поведение
2. **Реализация минимальной функциональности** для прохождения теста
3. **Создание модульных тестов** для отдельных компонентов
4. **Рефакторинг** с сохранением работоспособности тестов
5. **Документирование** реализованной функциональности

---

**Последнее обновление:** 2025-05-29
**Статус:** Компьютерное зрение реализовано, переходим к веб-автоматизации
