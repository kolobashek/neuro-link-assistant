# Подсистемы Neuro-Link Assistant

## Обзор

Neuro-Link Assistant разделен на несколько ключевых подсистем, каждая из которых отвечает за определенный аспект функциональности. Подсистемы взаимодействуют через четко определенные интерфейсы, что обеспечивает модульность и расширяемость.

## Файловая подсистема

**Назначение**: Операции с файлами и директориями, абстрагированные от платформы.

**Ключевые компоненты**:
- `AbstractFileSystem`: Базовый интерфейс для всех файловых операций
- `Win32FileSystem`: Реализация для Windows
- `FileSystemRegistry`: Реестр реализаций файловой системы

**Основные функции**:
- Чтение и запись файлов
- Создание и удаление директорий
- Перемещение и копирование файлов
- Проверка существования файлов и получение атрибутов

**Текущее состояние**: В процессе рефакторинга, основные абстракции определены.

## Подсистема ввода

**Назначение**: Эмуляция пользовательского ввода (клавиатура и мышь).

**Ключевые компоненты**:
- `AbstractKeyboard`: Интерфейс для эмуляции клавиатуры
- `AbstractMouse`: Интерфейс для эмуляции мыши
- `WindowsKeyboard` и `WindowsMouse`: Реализации для Windows
- `InputController`: Объединяет управление клавиатурой и мышью

**Основные функции**:
- Нажатие и удержание клавиш
- Перемещение курсора мыши
- Клики и двойные клики
- Прокрутка колеса мыши
- Эмуляция комбинаций клавиш

**Текущее состояние**: Частично реализована, проходит базовые тесты.

## Подсистема компьютерного зрения

**Назначение**: Анализ экрана, распознавание элементов интерфейса и отслеживание изменений.

**Ключевые компоненты**:
- `ScreenCapture`: Захват изображения экрана
- `ElementRecognition`: Распознавание элементов интерфейса
- `ElementLocalization`: Определение позиции элементов
- `ImageComparison`: Сравнение изображений
- `ScreenChanges`: Отслеживание изменений на экране

**Основные функции**:
- Захват снимков экрана
- Распознавание текста и элементов интерфейса
- Поиск элементов по шаблону
- Обнаружение изменений между кадрами
- Выделение областей интереса

**Текущее состояние**: Требует рефакторинга, базовые компоненты определены.

## Подсистема взаимодействия с веб

**Назначение**: Автоматизация веб-браузеров и взаимодействие с веб-страницами.

**Ключевые компоненты**:
- `BrowserController`: Управление браузером
- `ElementFinder`: Поиск элементов на странице
- `DOMInteraction`: Взаимодействие с DOM-структурой
- `WebNavigation`: Навигация по сайтам

**Основные функции**:
- Открытие и закрытие браузера
- Навигация по страницам
- Поиск элементов по CSS/XPath
- Заполнение форм
- Извлечение данных из страниц

**Текущее состояние**: Базовые компоненты определены, требуется интеграция с системой задач.

## Подсистема LLM

**Назначение**: Интеграция с языковыми моделями для генерации и анализа текста.

**Ключевые компоненты**:
- `APIClient`: Взаимодействие с API языковых моделей
- `PromptProcessor`: Обработка и оптимизация промптов
- `ResponseParser`: Парсинг ответов моделей
- `ActionPlanner`: Планирование действий на основе ответов LLM

**Основные функции**:
- Подключение к различным API языковых моделей
- Генерация и отправка промптов
- Обработка и структурирование ответов
- Формирование плана действий на основе ответов

**Текущее состояние**: Требуется рефакторинг и интеграция с системой задач.

## Подсистема базы данных

**Назначение**: Хранение данных о задачах, настройках и состоянии системы.

**Ключевые компоненты**:
- `DBConnection`: Управление подключением к БД
- `Repository`: Абстракция для работы с сущностями
- `Transaction`: Управление транзакциями
- Репозитории для различных сущностей (задачи, пользователи, рабочие процессы)

**Основные функции**:
- Хранение истории задач
- Сохранение настроек пользователя
- Управление шаблонами рабочих процессов
- Аналитика выполнения задач

**Текущее состояние**: Определена структура, требуется реализация.

## Взаимодействие между подсистемами

Подсистемы взаимодействуют через центральный реестр компонентов:

```
┌─────────────────┐      ┌─────────────────┐
│    Подсистема   │      │    Подсистема   │
│      ввода      │      │   комп. зрения  │
└────────┬────────┘      └────────┬────────┘
         │                        │
         ▼                        ▼
┌────────────────────────────────────────┐
│            Реестр компонентов          │
└────────────────────────────────────────┘
         ▲                        ▲
         │                        │
┌────────┴────────┐      ┌────────┴────────┐
│    Подсистема   │      │    Подсистема   │
│     файловая    │      │       веб       │
└─────────────────┘      └─────────────────┘
```

Задачи, создаваемые в системе, используют различные подсистемы для выполнения своих функций, получая доступ к ним через реестр компонентов.
