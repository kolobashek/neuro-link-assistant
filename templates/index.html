<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Нейро-Линк Ассистент</title>
		<link
			rel="stylesheet"
			href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
		/>
		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
		<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
		<style>
			/* Базовые стили для совместимости */
			body {
				font-family: 'Roboto', sans-serif;
				margin: 0;
				padding: 0;
				background-color: #f8f9fa;
				color: #202124;
			}

			.container {
				max-width: 1200px;
				margin: 0 auto;
				padding: 20px;
			}

			header {
				text-align: center;
				margin-bottom: 30px;
			}

			header h1 {
				color: #4285f4;
			}

			.input-section {
				margin-bottom: 30px;
			}

			.input-wrapper {
				position: relative;
				max-width: 600px;
				margin: 0 auto;
			}

			.search-input {
				width: 100%;
				padding: 12px 50px 12px 40px;
				border: 1px solid #dadce0;
				border-radius: 24px;
				font-size: 16px;
				outline: none;
			}

			.search-input:focus {
				border-color: #4285f4;
				box-shadow: 0 0 0 2px rgba(66, 133, 244, 0.2);
			}

			.input-icon {
				position: absolute;
				left: 12px;
				top: 50%;
				transform: translateY(-50%);
				color: #5f6368;
			}

			.submit-btn {
				position: absolute;
				right: 8px;
				top: 50%;
				transform: translateY(-50%);
				background-color: #4285f4;
				color: white;
				border: none;
				width: 36px;
				height: 36px;
				border-radius: 50%;
				display: flex;
				align-items: center;
				justify-content: center;
				cursor: pointer;
			}

			.submit-btn:hover {
				background-color: #3367d6;
			}

			#response-container {
				background-color: white;
				border-radius: 8px;
				padding: 20px;
				box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
				margin-bottom: 30px;
			}

			.execution-result {
				background-color: #f8f9fa;
				border: 1px solid #dadce0;
				border-radius: 4px;
				padding: 15px;
				font-family: monospace;
				white-space: pre-wrap;
				overflow-x: auto;
				margin-top: 15px;
			}

			.commands-section {
				margin-bottom: 30px;
			}

			.commands-grid {
				display: grid;
				grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
				gap: 16px;
			}

			.command-card {
				display: flex;
				align-items: center;
				padding: 16px;
				background-color: white;
				border-radius: 8px;
				border: 1px solid #dadce0;
				cursor: pointer;
				transition: transform 0.2s, box-shadow 0.2s;
			}

			.command-card:hover {
				transform: translateY(-2px);
				box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
			}

			.command-icon {
				width: 48px;
				height: 48px;
				border-radius: 50%;
				background-color: rgba(66, 133, 244, 0.1);
				display: flex;
				align-items: center;
				justify-content: center;
				margin-right: 16px;
			}

			.command-icon .material-icons {
				color: #4285f4;
				font-size: 24px;
			}

			.command-title {
				font-size: 16px;
				font-weight: 500;
				margin-bottom: 4px;
			}

			.command-alternatives {
				font-size: 12px;
				color: #5f6368;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<header>
				<h1>Нейро-Линк Ассистент</h1>
				<p>Интеллектуальный помощник для управления компьютером</p>
			</header>

			<section class="input-section">
				<form id="query-form">
					<div class="input-wrapper">
						<span class="material-icons input-icon">search</span>
						<input
							type="text"
							id="user-input"
							class="search-input"
							placeholder="Введите команду..."
							autocomplete="off"
						/>
						<button type="submit" class="submit-btn">
							<span class="material-icons">send</span>
						</button>
					</div>
				</form>
			</section>

			<section class="response-section">
				<div id="response-container" style="display: none">
					<div id="response-text"></div>
					<div id="execution-result"></div>
				</div>
			</section>

			<section class="commands-section">
				<h2>Доступные команды</h2>
				<div class="commands-grid">
					{% for command in commands %}
					<div class="command-card" data-command="{{ command.main }}">
						<div class="command-icon">
							<span class="material-icons">
								{% if 'открыть' in command.main or 'открой' in command.main %} open_in_new {% elif
								'скриншот' in command.main %} screenshot {% elif 'громкость' in command.main %}
								volume_up {% elif 'сказать' in command.main or 'скажи' in command.main %}
								record_voice_over {% elif 'выключить' in command.main or 'выключи' in command.main
								%} power_settings_new {% elif 'перезагрузить' in command.main or 'перезагрузи' in
								command.main %} restart_alt {% elif 'пауза' in command.main %} pause {% elif 'трек'
								in command.main or 'песня' in command.main %} skip_next {% elif 'калькулятор' in
								command.main %} calculate {% elif 'свернуть' in command.main or 'сверни' in
								command.main %} minimize {% elif 'блокнот' in command.main %} note {% else %}
								smart_toy {% endif %}
							</span>
						</div>
						<div>
							<div class="command-title">{{ command.main }}</div>
							{% if command.alternatives %}
							<div class="command-alternatives">Также: {{ command.alternatives|join(', ') }}</div>
							{% endif %}
						</div>
					</div>
					{% endfor %}
				</div>
			</section>
		</div>

		<script>
			document.addEventListener('DOMContentLoaded', function () {
				// Элементы формы и результатов
				const queryForm = document.getElementById('query-form')
				const userInput = document.getElementById('user-input')
				const responseText = document.getElementById('response-text')
				const executionResult = document.getElementById('execution-result')
				const responseContainer = document.getElementById('response-container')

				// Элементы команд
				const commandCards = document.querySelectorAll('.command-card')

				// Фокус на поле ввода при загрузке страницы
				userInput.focus()

				// Обработка отправки формы
				queryForm.addEventListener('submit', function (e) {
					e.preventDefault()

					const input = userInput.value.trim()
					if (!input) return

					// Показываем область результатов
					responseContainer.style.display = 'block'

					// Очищаем предыдущий ответ
					responseText.innerHTML = '<p>Обработка запроса...</p>'
					executionResult.innerHTML = ''

					// Отправляем запрос на сервер
					fetch('/query', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json',
						},
						body: JSON.stringify({ input: input }),
					})
						.then((response) => response.json())
						.then((data) => {
							// Отображаем ответ
							responseText.innerHTML = `<p>${data.response}</p>`

							// Отображаем результат выполнения
							if (data.execution_result) {
								executionResult.innerHTML = `<div class="execution-result">
							<pre>${data.execution_result}</pre>
						</div>`
							}
						})
						.catch((error) => {
							responseText.innerHTML = `<p style="color: #ea4335;">Ошибка: ${error.message}</p>`
						})

					// Очищаем поле ввода
					userInput.value = ''
				})

				// Обработка клика по карточке команды
				commandCards.forEach((card) => {
					card.addEventListener('click', function () {
						const command = this.getAttribute('data-command')
						userInput.value = command
						userInput.focus()

						// Автоматически отправляем форму
						queryForm.dispatchEvent(new Event('submit'))
					})
				})
			})
		</script>
	</body>
</html>
