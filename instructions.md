## 1. Обзор проекта

**Neuro-Link Assistant** - платформа для оркестрации различных моделей искусственного интеллекта и автоматизации задач. Система объединяет доступ к разным типам моделей AI и обеспечивает пошаговое выполнение задач.

## 2. Методология разработки - TDD "сверху вниз"

Проект разрабатывается с использованием **TDD (Test-Driven Development)** с подходом "сверху вниз":

1. **Системные тесты сначала** - создаем высокоуровневые тесты, описывающие работу системы в целом
2. **"Красный-Зеленый-Рефакторинг"**:
   - **Красный**: Начинаем с системных тестов, которые не проходят
   - **Зеленый**: Реализуем необходимую функциональность для прохождения тестов
   - **Рефакторинг**: Улучшаем код, сохраняя работающие тесты

## 3. Текущее состояние тестирования

### 3.1. Реализованные системные тесты

| Название теста | Статус | Описание | Приоритет |
|----------------|--------|----------|-----------|
| test_application_workflow | ✅ Проходит | Базовый рабочий процесс приложения | Выполнено |
| test_llm_basic_interaction | ✅ Проходит | Взаимодействие с языковыми моделями | Выполнено |
| test_task_management | ✅ Проходит | Жизненный цикл задачи и история | Выполнено |
| test_windows_automation | ✅ Проходит | Автоматизация работы с Windows-приложениями | Выполнено |
| test_file_operations | ✅ Проходит | Создание, чтение, запись, удаление файлов | Выполнено |
| test_computer_vision | ❌ Не проходит | Захват экрана и распознавание элементов | Средний |
| test_web_automation | ❌ Не проходит | Автоматизация веб-поиска | Средний |
| test_model_orchestration | ❌ Не проходит | Оркестрация нескольких моделей | Низкий |
| test_plugin_system | ⚠️ Пропускается | Загрузка и выполнение плагинов | Низкий |

**Прогресс: 5/9 тестов проходят (55%)**

### 3.2. Последние достижения (2025-05-23)

✅ **Реализованы ключевые компоненты**:
- **TaskManager** с методами `save_task()`, `get_task()`, `get_task_history()`
- **PluginManager.get_loaded_plugins()** для совместимости с тестами
- Регистрация TaskManager в SystemInitializer

✅ **Системные тесты**: 3 из 9 проходят (33% прогресс)
✅ **Покрытие кода**: 14% (было 13%)

### 3.3. Необходимые компоненты для реализации

Для прохождения оставшихся тестов требуется:

1. **Файловые операции** (высокий приоритет):
   - Интеграция абстракций из `core/common/filesystem/base.py`
   - Реализация конкретных операций для Windows
   - Распознавание файловых команд в Task

2. **Windows автоматизация** (высокий приоритет):
   - Запуск приложений (калькулятор, блокнот)
   - Взаимодействие с элементами окон
   - Управление вводом для выполнения действий

3. **Компьютерное зрение** (средний приоритет):
   - Захват экрана
   - Поиск элементов на экране
   - Распознавание текста и объектов

4. **Веб-автоматизация** (средний приоритет):
   - Управление браузером
   - Выполнение поисковых запросов
   - Извлечение данных с веб-страниц

## 4. План разработки (обновленный)

### 4.1. Ближайшие задачи (высокий приоритет)

1. **Файловые операции**:
   ```bash
   pytest tests/system/test_file_operations.py -v
   ```
   - Интеграция `core/common/filesystem/base.py`
   - Реализация Windows-специфичных файловых операций
   - Подключение к Task для распознавания команд

2. **Автоматизация Windows**:
   ```bash
   pytest tests/system/test_windows_automation.py -v
   ```
   - Запуск приложений через subprocess/os
   - Интеграция с `core/platform/windows/input/`
   - Поиск и взаимодействие с окнами

### 4.2. Задачи средней срочности

1. **Компьютерное зрение**:
   ```bash
   pytest tests/system/test_computer_vision.py -v
   ```

2. **Веб-автоматизация**:
   ```bash
   pytest tests/system/test_web_automation.py -v
   ```

### 4.3. Долгосрочные задачи

1. **Оркестрация моделей**:
   ```bash
   pytest tests/system/test_model_orchestration.py -v
   ```

2. **Система плагинов** (создание тестовых плагинов)

## 5. Архитектура системы

```
core/
├── common/                       # Общие компоненты и базовые классы
│   ├── error_handler.py          # Обработка ошибок
│   ├── filesystem/               # Абстракции файловой системы ✅
│   ├── input/                    # Абстракции ввода ✅
│   └── registry/                 # Компоненты реестра ✅
│
├── platform/                     # Платформенно-зависимый код
│   └── windows/                  # Реализации для Windows
│       ├── filesystem/           # NEW: Файловые операции Windows
│       └── input/                # Ввод Windows ✅
│
├── system.py                     # Класс System ✅
├── system_initializer.py         # Инициализатор системы ✅
├── task.py                       # Класс Task и TaskResult ✅
├── task_manager.py               # ✅ Менеджер задач
├── plugin_manager.py             # ✅ Менеджер плагинов
│
└── подсистемы (vision, web, llm) # Требуют интеграции
```

## 6. Следующие шаги по TDD

1. **Файловые операции** (высокий приоритет):
   ```bash
   pytest tests/system/test_file_operations.py -v
   ```

2. **Windows автоматизация** (высокий приоритет):
   ```bash
   pytest tests/system/test_windows_automation.py -v
   ```

3. **Постепенная реализация средне- и низкоприоритетных тестов**

## 7. Стандарты кодирования

- **Классы**: CamelCase (например, `FileManager`)
- **Методы и функции**: snake_case (например, `read_file`)
- **Константы**: UPPER_SNAKE_CASE (например, `DEFAULT_TIMEOUT`)
- **Абстракции**: префикс Abstract (например, `AbstractFileSystem`)
- **Docstrings**: для всех публичных классов и методов
- **Типизация**: использовать аннотации типов (type hints)

## 8. Приоритеты интеграции существующего кода

1. **core/common/filesystem/**: уже создана абстракция, требуется реализация ⭐
2. **core/platform/windows/input/**: существуют клавиатура и мышь, требуется интеграция ⭐
3. **core/common/error_handler.py**: используется в системе, расширять по необходимости

## 9. Покрытие кода и метрики

- **Текущее покрытие тестами**: **14%** (↗️ было 13%)
- **Целевое покрытие**: **80%**
- **Системные тесты**: **3/9 проходят** (33% прогресс)
- Регулярно проверять покрытие новой функциональности тестами

## 10. Организация проекта и процесс разработки

1. **Создание системного теста** - определяем требуемое поведение
2. **Реализация минимальной функциональности** для прохождения теста
3. **Создание модульных тестов** для отдельных компонентов
4. **Рефакторинг** с сохранением работоспособности тестов
5. **Документирование** реализованной функциональности

---

**Последнее обновление:** 2025-05-28
**Статус:** TaskManager и PluginManager реализованы, переходим к файловым операциям
